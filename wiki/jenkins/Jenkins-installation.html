<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
    <link rel="shortcut icon" href="/wiki/static/images/favicon.png" type="image/x-icon">
    <link rel="icon" href="/wiki/static/images/favicon.png" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>Jenkins任务部署 - Wiki</title>
    <meta name="keywords" content="wiki, simple"/>
    <meta name="description" content=""/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>

    <div id="container" style="position:relative">
      <button type="button" style="position:absolute; left:0; margin-top: -18px; margin-left: -1px;" class="blog-button .btn"><a href="https://longshilin.com/blog">Back Blog</a></button>
      <!-- <div id="google_translate_element" style="position:absolute; right:0; margin-top: -22px; margin-right: -1px;"></div> -->
      
<div id="header">
  <div class="post-nav"><a href="/wiki/">Home</a>&nbsp;&#187;&nbsp;<a href="/wiki/#jenkins">jenkins</a>&nbsp;&#187;&nbsp;Jenkins任务部署
    <span class="updated">Page Updated&nbsp;
      2018-09-04 18:11
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">Jenkins任务部署</div>

  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">配置全局设置</a></li>
<li><a href="#_2">全局工具配置</a><ul>
<li><a href="#jdk">JDK 安装</a></li>
<li><a href="#git-installations">Git installations</a></li>
<li><a href="#maven">Maven 安装</a></li>
</ul>
</li>
<li><a href="#jenkins-plugin">安装Jenkins Plugin</a></li>
<li><a href="#jenkins-deploy-web-project">配置Jenkins任务 - deploy web project</a><ul>
<li><a href="#_3">源码管理</a></li>
<li><a href="#_4">构建触发器</a></li>
<li><a href="#_5">构建环境</a></li>
<li><a href="#maven_1">Maven构建</a><ul>
<li><a href="#pre-steps">Pre Steps</a></li>
<li><a href="#build">Build</a></li>
<li><a href="#post-steps">Post Steps</a><ul>
<li><a href="#run-only-if-build-succeeds">√ Run only if build succeeds</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_6">构建设置</a><ul>
<li><a href="#e-mail-notification">E-mail Notification</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h1 id="_1">配置全局设置</h1>
<p>如果想通过curl命令，远程发送请求的方式触发Jenkins进行调度，需要关闭<code>全局安全设置</code>中的<code>防止跨站点请求伪造</code></p>
<h1 id="_2">全局工具配置</h1>
<p>查看机器上的命令：</p>
<h2 id="jdk">JDK 安装</h2>
<ul>
<li><code>whereis java</code></li>
<li>别名 <code>jdk1.8.0_162</code></li>
<li>JAVA_HOME <code>/usr/java/jdk1.8.0_162</code></li>
</ul>
<h2 id="git-installations">Git installations</h2>
<ul>
<li><code>sudo yum install -y git</code></li>
<li>Name <code>git 1.8.3.1</code></li>
<li>Path to Git executable <code>/usr/bin/git</code></li>
</ul>
<h2 id="maven">Maven 安装</h2>
<ul>
<li><code>wget http://mirrors.ocf.berkeley.edu/apache/maven/maven-3/3.5.4/binaries/apache-maven-3.5.4-bin.tar.gz</code></li>
<li>Name <code>Apache Maven 3.5.4</code></li>
<li>MAVEN_HOME <code>/usr/maven</code></li>
</ul>
<h1 id="jenkins-plugin">安装Jenkins Plugin</h1>
<ul>
<li>Publish Over SSH (远程Shell)</li>
<li>Maven Integration (Maven集成，否则新建任务的时候没有<strong>Maven Project</strong>)</li>
<li>Email Extension Template (邮件通知)</li>
</ul>
<h1 id="jenkins-deploy-web-project">配置Jenkins任务 - deploy web project</h1>
<h2 id="_3">源码管理</h2>
<p>通过git来管理源码，这里填入<strong>Repositories</strong>中的<strong>URL</strong>和<strong>Credentials</strong></p>
<h2 id="_4">构建触发器</h2>
<p>触发器选项，按照需求来选择。默认不用构建</p>
<h2 id="_5">构建环境</h2>
<p>构建环境，默认无需勾选</p>
<h2 id="maven_1">Maven构建</h2>
<h3 id="pre-steps">Pre Steps</h3>
<h3 id="build">Build</h3>
<p>Root POM：<code>deploy/pom.xml</code><br />
Goals and options：<code>clean package -Pdev</code></p>
<h3 id="post-steps">Post Steps</h3>
<h4 id="run-only-if-build-succeeds">√ Run only if build succeeds</h4>
<div class="hlcode"><pre>sudo rm -rf /usr/app/tomcat/webapps/deploy <span class="err">&amp;&amp;</span> sudo cp -f <span class="cp">${</span><span class="n">WORKSPACE</span><span class="cp">}</span>/deploy/target/deploy.war /usr/app/tomcat/webapps <span class="err">&amp;&amp;</span> sudo systemctl restart tomcat
</pre></div>


<h2 id="_6">构建设置</h2>
<h3 id="e-mail-notification">E-mail Notification</h3>
<p>Recipients <code>Email-Address</code></p>
<p><em>修改记录</em></p>
<blockquote>
<p>2018-09-04 新增该条目</p>
</blockquote>

  <br>
  <!-- Valine comment -->
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments.</a></noscript>
  </div>
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <script>
    new Valine({
      av: AV,
      el: '#disqus_thread',
      appId: 'pMgClbOyqp0K4AQxpMUJuskE-9Nh9j0Va',
      appKey: 'CzXcgRguvCJa0EkILaN5F4HX',
      notify: false,
      verify: false,
      avatar: 'mm',
      placeholder: 'write a comment...',
      visitor: true
    });
  </script>
      <br><br>

    </div>

    <div id="footer">

      <span>
          <p>Copyright © 2018 <a href="https://longshilin.com/wiki" target="_blank">Longshilin</a>.</p>
          <!-- 署名协议 -->
          <p><script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1274850654'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1274850654%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>&nbsp; |&nbsp;
            Site Generated 2018-11-11 07:56:49 &nbsp; |&nbsp; <u><a href="https://longsl.mit-license.org/" target="_blank">MIT License</a></u></p>
      </span>
    </div>

    
    
  </body>
</html>

<!-- add google translate - ->
<script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({pageLanguage: 'zh-CN', layout: google.translate.TranslateElement.FloatPosition.TOP_RIGHT, multilanguagePage: true, gaTrack: true, gaId: 'UA-125053144-2'}, 'google_translate_element');
  }
</script><script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
-->